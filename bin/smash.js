var k=void 0,r=!0,x=null,y=!1;function z(){return function(){}}var A,aa=this;function ba(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==k?d[e]=b:d=d[e]?d[e]:d[e]={}}function B(a,b){function c(){}c.prototype=b.prototype;a.ya=b.prototype;a.prototype=new c};function S(){this.name="";this.xa=0;this.q=y}S.prototype.s=z();S.prototype.w=z();function ca(a,b){S.call(this);a&&this.s(a,b)}B(ca,S);ca.prototype.s=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,r);c.onreadystatechange=function(){200==this.status&&4==this.readyState&&b(a,c.responseText)};c.send()};function da(a){S.call(this);this.a=a||T();this.id=this.a.createProgram();this.va=[];this.i=[];this.j=x;this.l={};this.X=0;this.N=this.T=x}B(da,S);A=da.prototype;A.bind=function(){this.a.useProgram(this.id)};A.create=function(a,b){var c=this.a.createShader(b);this.a.shaderSource(c,a);this.a.compileShader(c);return!this.a.getShaderParameter(c,35713)?(alert("Shader: \n"+this.a.getShaderInfoLog(c)),x):c};
A.B=function(a,b){!b||!a?alert("Shader: Missing vertex or fragment shader."):(this.a.attachShader(this.id,a),this.a.attachShader(this.id,b),this.a.linkProgram(this.id),this.a.getProgramParameter(this.id,35714)?(this.a.deleteShader(a),this.a.deleteShader(b)):alert("Shader: Error in the shader ("+this.id+")"))};
function ea(a){for(var b=-1,c=x,d=0,e=0,f=0,g=a.i.length;f<g;f++)if(c=a.i[f]){b=a.a.getAttribLocation(a.id,c.name);c.offset=d;c.M||(c.M=y);-1!=b?a.i[f].id=b:a.i.splice(f,1);switch(c.type){case 5126:e=4;break;case 5121:e=1}d+=c.count*e}f=0;for(g=a.i.length;f<g;f++)a.i[f].na=d}function fa(a,b){for(var c in b)b[c].id=a.a.getUniformLocation(a.id,c.toString())}
function ga(a){a.l={uTexture:{type:3,value:x},uAmbientLight:{type:4,value:x},uMvp:{type:0,value:x},uProjectionMatrix:{type:0,value:x},uViewMatrix:{type:0,value:x},uNormal:{type:1,value:x},uCameraPosition:{type:4,value:x}};a.l.uLightCount={type:8,value:x};for(var b=0;14>b;b++){var c="uLights["+b+"]";a.l[c+".attenuation"]={type:4,value:x};a.l[c+".direction"]={type:4,value:x};a.l[c+".position"]={type:4,value:x};a.l[c+".color"]={type:4,value:x}}fa(a,a.l)}
A.s=function(a){function b(a,b){c.w(a,b)}var c=this,d=a+"/fragment.frag";new ca(a+"/vertex.vert",b);new ca(d,b)};
A.w=function(a,b){this.X++;switch(a.split(".").pop()){case "vert":this.T=this.create(b,35633);break;case "frag":this.N=this.create(b,35632)}2==this.X&&(this.B(this.T,this.N),this.j!=x&&(fa(this,this.j),ga(this)),0<this.i.length||this.I([{name:"aPosition",count:3,type:5126},{name:"aColor",count:4,type:5121,M:r},{name:"aTexCoord",count:2,type:5126},{name:"aNormal",count:3,type:5126}]),ea(this),this.q=r,delete this.N,delete this.T)};
function ha(a,b){for(var c in b)if(!(b[c].id==x||b[c].value==x))switch(b[c].type){case 0:a.a.uniformMatrix4fv(b[c].id,y,b[c].value);break;case 1:a.a.uniformMatrix3fv(b[c].id,y,b[c].value);break;case 3:a.a.uniform1i(b[c].id,y,b[c].value);break;case 4:a.a.uniform3fv(b[c].id,b[c].value);break;case 7:a.a.uniform1iv(b[c].id,b[c].value);break;case 6:a.a.uniform1f(b[c].id,b[c].value);break;case 8:a.a.uniform1i(b[c].id,b[c].value)}}A.set=function(a,b){this.I(b);ia(this,a)};
A.I=function(a){this.q&&this.i==x?(this.i=a,ea(this)):this.i=a};function ia(a,b){a.q&&a.j==x?(a.j=b,fa(a,b),ga(a)):a.j=b};function la(a,b,c,d){this.o=new Uint8Array(4);this.set(a||255,b||255,c||255,d||255)}la.prototype.set=function(a,b,c,d){this.o[0]=a;this.o[1]=b;this.o[2]=c;this.o[3]=d};function U(){this.ca=[]}U.Y=function(){return U.$?U.$:U.$=new U};U.prototype.add=function(a,b){this.ca[a]=b};U.prototype.get=function(a){a=this.ca[a];return a==k?x:a};function ma(){this.sa=na;this.V=4;this.ga=V(0.5,0.5,0.5);this.ja=V(1,1,1);this.ma=V(1,1,1);this.la=5;this.f=x;this.S=[];this.ua=x;this.za=this.visible=r}var na=3;function oa(a,b){a.S[a.S.length]=b}ma.prototype.da=z();function W(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}W.prototype.BYTES_PER_ELEMENT=8;W.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};W.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{W.BYTES_PER_ELEMENT=8}catch(pa){}W.prototype.BYTES_PER_ELEMENT=W.prototype.BYTES_PER_ELEMENT;W.prototype.set=W.prototype.set;W.prototype.toString=W.prototype.toString;ba("Float64Array",W)};function X(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}X.prototype.BYTES_PER_ELEMENT=4;X.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};X.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(X.BYTES_PER_ELEMENT=4,X.prototype.BYTES_PER_ELEMENT=X.prototype.BYTES_PER_ELEMENT,X.prototype.set=X.prototype.set,X.prototype.toString=X.prototype.toString,ba("Float32Array",X));function V(a,b,c){var d=new Float32Array(3);d[0]=a;d[1]=b;d[2]=c;return d}function qa(a,b){var c=a[0],d=a[1],e=a[2],c=1/Math.sqrt(c*c+d*d+e*e);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c}function ra(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];c[0]=e*b-a*g;c[1]=a*f-d*b;c[2]=d*g-e*f};function Y(){return new Float32Array(16)}function sa(a,b,c,d,e,f,g,h,n,p,l,m,s,t,u,v,w){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=n;a[8]=p;a[9]=l;a[10]=m;a[11]=s;a[12]=t;a[13]=u;a[14]=v;a[15]=w;return a}function ta(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}function ua(a,b,c,d){var e=a[1]*b+a[5]*c+a[9]*d+a[13],f=a[2]*b+a[6]*c+a[10]*d+a[14],g=a[3]*b+a[7]*c+a[11]*d+a[15];a[12]=a[0]*b+a[4]*c+a[8]*d+a[12];a[13]=e;a[14]=f;a[15]=g}
function va(a,b,c,d){sa(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])}function wa(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],n=a[10],p=a[11],l=Math.cos(b),m=Math.sin(b);a[4]=c*l+g*m;a[5]=d*l+h*m;a[6]=e*l+n*m;a[7]=f*l+p*m;a[8]=c*-m+g*l;a[9]=d*-m+h*l;a[10]=e*-m+n*l;a[11]=f*-m+p*l}
function xa(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],n=a[10],p=a[11],l=Math.cos(b),m=Math.sin(b);a[0]=c*l+g*-m;a[1]=d*l+h*-m;a[2]=e*l+n*-m;a[3]=f*l+p*-m;a[8]=c*m+g*l;a[9]=d*m+h*l;a[10]=e*m+n*l;a[11]=f*m+p*l}function ya(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],n=a[6],p=a[7],l=Math.cos(b),m=Math.sin(b);a[0]=c*l+g*m;a[1]=d*l+h*m;a[2]=e*l+n*m;a[3]=f*l+p*m;a[4]=c*-m+g*l;a[5]=d*-m+h*l;a[6]=e*-m+n*l;a[7]=f*-m+p*l}new Float64Array(3);new Float64Array(3);
var za=[new Float64Array(4),new Float64Array(4),new Float64Array(4)];new Float64Array(16);function Aa(){var a=Y();a[0]=a[5]=a[10]=a[15]=1;this.d=a;this.position=new Float32Array(3);this.rotation=new Float32Array(3);this.scale=V(1,1,1);this.t=r}function Ba(a,b,c,d){var e=a.position;e[0]=b;e[1]=c;e[2]=d;a.t=r}function Ca(a){var b=a.scale;b[0]=0.02;b[1]=0.02;b[2]=0.02;a.t=r}
Aa.prototype.O=function(){if(this.t){var a=this.d,b=this.position[0],c=this.position[1],d=this.position[2];a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;a[12]=b;a[13]=c;a[14]=d;a[15]=1;va(this.d,this.scale[0],this.scale[1],this.scale[2]);wa(this.d,this.rotation[0]);xa(this.d,this.rotation[1]);ya(this.d,this.rotation[2]);this.t=y}return this.d};function Z(a){this.parent=x;this.children=[];this.m=a||new Aa}Z.prototype.add=function(a){a.parent==x&&(this.children[this.children.length]=a)};var Da=[];function T(){var a;a==k&&(a="default");return Da[a]};function $(a){S.call(this);this.id=T().createTexture();this.height=this.width=0;this.D=x;a!=k&&this.s(a)}B($,S);
$.prototype.s=function(a){var b=this;if(a!=k){var c=/(?:\.([^.]+))?$/.exec(a)[1];if(-1!=["png","jpg","gif","bmp"].indexOf(c)){var d=new Image;d.onload=function(){b.width=this.width;b.height=this.height;b.w(a,d)};d.src=a}else{var e=document.createElement("video");e.wa="auto";document.body.appendChild(e);e.setAttribute("src",a);e.setAttribute("style","display: none;");e.addEventListener("canplaythrough",function(){var c=T();b.bind();c.texParameteri(3553,10242,33071);c.texParameteri(3553,10243,33071);
b.w(a,e)},r);e.play();b.D=e}}};$.prototype.w=function(a,b){var c=T();this.bind();c.texParameteri(3553,10240,9729);c.texParameteri(3553,10241,9729);this.update(b);T().bindTexture(3553,x);this.q=r};$.prototype.update=function(a){if(!(this.q===y&&a===k)&&!(a==x&&this.D==x)){a==x&&this.D!=x&&(a=this.D);var b=T();this.bind();b.pixelStorei(37440,1);b.texImage2D(3553,0,6408,6408,5121,a);T().bindTexture(3553,x)}};$.prototype.bind=function(){T().bindTexture(3553,this.id)};function Ea(a){this.id=x;this.F=0;this.a=a||T()}Ea.prototype.bind=z();Ea.prototype.fill=z();function Fa(a){Ea.call(this,a);this.id=this.a.createBuffer()}B(Fa,Ea);Fa.prototype.bind=function(){this.a.bindBuffer(34962,this.id)};Fa.prototype.fill=function(a){this.bind();this.a.bufferData(34962,a,35044)};function Ga(a){Ea.call(this,a);this.id=this.a.createBuffer();this.W=5123}B(Ga,Ea);Ga.prototype.bind=function(){this.a.bindBuffer(34963,this.id)};Ga.prototype.fill=function(a){this.bind();this.a.bufferData(34963,a,35044);this.F=a.length;this.W=255>this.F?5121:65535>this.F?5123:5125};function Ha(a,b,c){this.x=a||0;this.y=b||0;this.fa=c||0}Ha.prototype.set=function(a,b,c){this.x=a;this.y=b;this.fa=c};function Ia(){this.h=[];this.g=[];this.b=[];this.aa=r;this.v=[];this.k=[];this.z=[];this.r=new Ga;this.L=new Fa}Ia.prototype.K=function(a){for(var b=0,c=a.length;b<c;b+=3){var d=this.h.length;this.h[d]=new Ha(a[b],a[b+1],a[b+2]);this.v[d]=new la(255,255,255,255)}};Ia.prototype.Q=function(a){this.g=a};Ia.prototype.R=function(a){for(var b=0,c=0,d=a.length;b<d;b+=3,c++)this.k[c]=[a[b],a[b+1],a[b+2]]};function Ja(a,b){Z.call(this);this.e=this.c=x;this.I(a,b)}B(Ja,Z);Ja.prototype.I=function(a,b){delete this.c;delete this.e;a instanceof Object?(this.e=a.e,this.c=a.c||new ma):b!==k&&(this.e=a,this.c=b||new ma)};function Ka(){var a=new Ia;a.K([-0.5,-0.5,0.5,0.5,-0.5,0.5,0.5,0.5,0.5,-0.5,0.5,0.5,-0.5,-0.5,-0.5,-0.5,0.5,-0.5,0.5,0.5,-0.5,0.5,-0.5,-0.5,-0.5,0.5,-0.5,-0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,-0.5,-0.5,-0.5,-0.5,0.5,-0.5,-0.5,0.5,-0.5,0.5,-0.5,-0.5,0.5,0.5,-0.5,-0.5,0.5,0.5,-0.5,0.5,0.5,0.5,0.5,-0.5,0.5,-0.5,-0.5,-0.5,-0.5,-0.5,0.5,-0.5,0.5,0.5,-0.5,0.5,-0.5]);a.Q([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);for(var b=[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,
0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],c=0,d=0,e=b.length;c<e;c+=2,d++)a.z[d]=[b[c],b[c+1]];a.R([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]);for(var d=a.h,f=e=0,g=0,b=0,e=d.length,c=16+(0<a.z.length?8:0),c=c+(0<a.k.length?12:0),h=new ArrayBuffer(e*c),e=0,f=d.length;e<f;e++){var g=e*c,n=new Float32Array(h,g,3);n[0]=a.h[e].x;n[1]=a.h[e].y;n[2]=a.h[e].fa;g=new Uint8Array(h,
g+12,4);g[0]=a.v[e].o[0];g[1]=a.v[e].o[1];g[2]=a.v[e].o[2];g[3]=a.v[e].o[3]}b+=16;if(0<a.z.length){e=0;for(f=d.length;e<f;e++)g=e*c,g=new Float32Array(h,g+b,2),g[0]=a.z[e][0],g[1]=a.z[e][1];b+=8}if(0<a.k.length){e=0;for(f=d.length;e<f;e++)g=e*c,d=new Float32Array(h,g+b,3),d[0]=a.k[e][0],d[1]=a.k[e][1],d[2]=a.k[e][2]}a.L.fill(h);c=[];if(0!=a.b.length)if(b=a.aa?3:4,c=a.b.length*b,c=255>c?new Uint8Array(1*c):65535>c?new Uint16Array(2*c):new Uint32Array(4*c),a.aa){d=0;for(e=a.b.length;d<e;d++)f=d*b,c[f]=
a.b[d].pa,c[f+1]=a.b[d].qa,c[f+2]=a.b[d].ra}else{d=0;for(e=a.b.length;d<e;d++)f=d*b,c[f]=a.b[d].pa,c[f+1]=a.b[d].qa,c[f+2]=a.b[d].ra,c[f+3]=a.b[d].Aa}else c=a.g.length,c=255>c?new Uint8Array(a.g):65535>c?new Uint16Array(a.g):new Uint32Array(a.g);a.r.fill(c);return a};function La(){ma.call(this);var a=U.Y();if(a.get("meshShader")==x){var b=new da;b.s("data/shaders/texture");ia(b,{uModel:{type:0,value:x},"uMaterial.ambient":{type:4,value:x},"uMaterial.diffuse":{type:4,value:x},"uMaterial.specular":{type:4,value:x},"uMaterial.shininess":{type:6,value:0}});a.add("meshShader",b)}this.f=U.Y().get("meshShader")}B(La,ma);
La.prototype.da=function(){this.f.j["uMaterial.ambient"].value=this.ga;this.f.j["uMaterial.diffuse"].value=this.ja;this.f.j["uMaterial.specular"].value=this.ma;this.f.j["uMaterial.shininess"].value=this.la};function Ma(){Z.call(this);this.color=V(1,1,1);this.direction=V(1,1,1);this.ia=V(0,1,0)}B(Ma,Z);function Na(a){a.color[0]=0;a.color[1]=1;a.color[2]=0};function Oa(){Z.call(this);this.ha=V(1,1,1);this.n=[]}B(Oa,Z);Oa.prototype.add=function(a){a instanceof Ma?this.n[this.n.length]=a:a.parent==x&&Z.prototype.add.call(this,a)};function Pa(a){Aa.call(this);this.U=Y();this.H=Y();this.G=new Float32Array(9);this.oa=V(0,1,0);Qa(this);switch(a){case "2D":a=Y();this.H=sa(a,1,0,0,0,0,1,0,0,0,0,-2/99,0,-0,-0,-101/99,1);break;default:a=800/600;var b=Y(),c=Math.sin(22.5);0==c||0==a?a=b:(c=Math.cos(22.5)/c,a=sa(b,c/a,0,0,0,0,c,0,0,0,0,-101/99,-1,0,0,-200/99,0));this.H=a}}B(Pa,Aa);
function Qa(a){var b=Y(),c=a.position,d=a.oa,e=za[0],f=[0,0,-5];e[0]=f[0]-c[0];e[1]=f[1]-c[1];e[2]=f[2]-c[2];qa(e,e);e[3]=0;f=za[1];ra(e,d,f);qa(f,f);f[3]=0;d=za[2];ra(f,e,d);qa(d,d);d[3]=0;e[0]=-e[0];e[1]=-e[1];e[2]=-e[2];ta(b,0,f);ta(b,1,d);ta(b,2,e);b[3]=0;b[7]=0;b[11]=0;b[15]=1;ua(b,-c[0],-c[1],-c[2]);a.U=b}
Pa.prototype.O=function(){if(this.t){var a=this.U,b=Y();b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];this.d=b;ua(this.d,this.position[0],this.position[1],this.position[2]);va(this.d,this.scale[0],this.scale[1],this.scale[2]);wa(this.d,this.rotation[0]);xa(this.d,this.rotation[1]);ya(this.d,this.rotation[2]);var c=this.H,d=this.d,a=this.d,b=c[0],e=c[1],f=c[2],g=c[3],h=c[4],
n=c[5],p=c[6],l=c[7],m=c[8],s=c[9],t=c[10],u=c[11],v=c[12],w=c[13],C=c[14],c=c[15],D=d[0],E=d[1],F=d[2],G=d[3],H=d[4],I=d[5],J=d[6],K=d[7],L=d[8],M=d[9],N=d[10],O=d[11],P=d[12],Q=d[13],R=d[14],d=d[15];a[0]=b*D+h*E+m*F+v*G;a[1]=e*D+n*E+s*F+w*G;a[2]=f*D+p*E+t*F+C*G;a[3]=g*D+l*E+u*F+c*G;a[4]=b*H+h*I+m*J+v*K;a[5]=e*H+n*I+s*J+w*K;a[6]=f*H+p*I+t*J+C*K;a[7]=g*H+l*I+u*J+c*K;a[8]=b*L+h*M+m*N+v*O;a[9]=e*L+n*M+s*N+w*O;a[10]=f*L+p*M+t*N+C*O;a[11]=g*L+l*M+u*N+c*O;a[12]=b*P+h*Q+m*R+v*d;a[13]=e*P+n*Q+s*R+w*d;a[14]=
f*P+p*Q+t*R+C*d;a[15]=g*P+l*Q+u*R+c*d;this.t=y}return this.d};function Ra(){this.p=x;var a=document.createElement("canvas");a.id="renderer_"+Math.round(100*Math.random());a.style.width="100%";a.style.height="100%";this.C=a;this.size={ea:800,Z:600}}function Sa(a){var b=document.body,c=x,c="string"==typeof b?document.getElementById(b):b;c.appendChild(a.C)}A=Ra.prototype;A.J=function(a,b){this.C.width=this.size.ea=a;this.C.height=this.size.Z=b};A.P=function(a,b){for(var c=a.children,d=0,e=c.length;d<e;d++)this.ba(a,b,c[d])};A.ba=z();A.clear=z();A.getContext=function(){return this.p};function Ta(){this.e=this.ta=this.f=x};function Ua(){Ra.call(this);var a=x;try{a=this.C.getContext("experimental-webgl",{premultipliedAlpha:y,alpha:y})}catch(b){}a===x&&alert("Missing context");this.p=Da["default"]=a;this.u=new Ta}B(Ua,Ra);Ua.prototype.J=function(a,b){Ra.prototype.J.call(this,a,b);this.p.viewport(0,0,this.size.ea,this.size.Z);this.p.enable(2929)};Ua.prototype.P=function(a,b){this.clear();Ra.prototype.P.call(this,a,b)};Ua.prototype.clear=function(){this.p.clear(16640);this.p.clearColor(0,0,0,1)};
Ua.prototype.ba=function(a,b,c){if(c.c.f.q!==y){c.e!=this.u.e&&(c.e.L.bind(),c.e.r.bind(),this.u.e=c.e);var d=c.c.f;d.bind();this.u.f=d;var e="",d=this.u.f.l;d.uMvp.value=b.O();var e=d.uNormal,f=b.d,g=b.G,h=f[0],n=f[1],p=f[2],l=f[3],m=f[4],s=f[5],t=f[6],u=f[7],v=f[8],w=f[9],C=f[10],D=f[11],E=f[12],F=f[13],G=f[14],f=f[15],H=h*s-n*m,I=h*t-p*m,J=h*u-l*m,K=n*t-p*s,L=n*u-l*s,M=p*u-l*t,N=v*F-w*E,O=v*G-C*E,P=v*f-D*E,Q=w*G-C*F,R=w*f-D*F,ja=C*f-D*G,q=H*ja-I*R+J*Q+K*P-L*O+M*N;0!=q&&(q=1/q,g[0]=(s*ja-t*R+u*
Q)*q,g[1]=(-n*ja+p*R-l*Q)*q,g[2]=(F*M-G*L+f*K)*q,g[3]=(-w*M+C*L-D*K)*q,g[4]=(-m*ja+t*P-u*O)*q,g[5]=(h*ja-p*P+l*O)*q,g[6]=(-E*M+G*J-f*I)*q,g[7]=(v*M-C*J+D*I)*q,g[8]=(m*R-s*P+u*N)*q,g[9]=(-h*R+n*P-l*N)*q,g[10]=(E*L-F*J+f*H)*q,g[11]=(-v*L+w*J-D*H)*q,g[12]=(-m*Q+s*O-t*N)*q,g[13]=(h*Q-n*O+p*N)*q,g[14]=(-E*K+F*I-G*H)*q,g[15]=(v*K-w*I+C*H)*q);h=g=b.G;h==g?(n=g[1],p=g[2],l=g[5],h[1]=g[3],h[2]=g[6],h[3]=n,h[5]=g[7],h[6]=p,h[7]=l):(h[0]=g[0],h[1]=g[3],h[2]=g[6],h[3]=g[1],h[4]=g[4],h[5]=g[7],h[6]=g[2],h[7]=
g[5],h[8]=g[8]);e.value=b.G;d.uProjectionMatrix.value=b.H;d.uViewMatrix.value=b.U;d.uCameraPosition.value=b.position;d.uLightCount.value=a.n.length;d.uAmbientLight.value=a.ha;b=0;for(g=a.n.length;b<g;b++)e="uLights["+b+"]",d[e+".color"].value=a.n[b].color,d[e+".direction"].value=a.n[b].direction,d[e+".attenuation"].value=a.n[b].ia,d[e+".position"].value=a.n[b].m.position;a=this.u.f;ha(a,a.l);c.c.f.j.uModel.value=c.m.O();a=c.c.f;d=c.c.S;b=0;for(e=d.length;b<e;b++)d[b].q===r&&(a.a.activeTexture(33984),
d[b].bind());c.c.da();a=c.c.f;ha(a,a.j);a=c.c.f;d=x;b=0;for(e=a.i.length;b<e;b++)d=a.i[b],a.a.enableVertexAttribArray(d.id),a.a.vertexAttribPointer(d.id,d.count,d.type,d.M,d.na,d.offset);this.p.drawElements(c.c.V,c.e.r.F,c.e.r.W,0)}};function Va(){Ma.call(this)}B(Va,Ma);function Wa(){this.r=new Ga;this.b=[];this.g=[];this.k=[];this.A=[];this.L=new Fa;this.h=[]}
Wa.prototype.B=function(){if(0<this.b.length){this.g=[];for(var a=0,b=0,c=0,d=0,e=new ArrayBuffer(144*this.h.length),f=0,g=this.b.length;f<g;f++)for(var h=c=0,n=this.b[f].length;h<n;h++){var b=this.b[f][h],d=36*f,p=new Float32Array(e,d+c,3);p[0]=this.h[b][0];p[1]=this.h[b][1];p[2]=this.h[b][2];c+=12;b=new Uint8Array(e,d+c,4);b[0]=1;b[1]=1;b[2]=1;b[3]=1;c+=4;b=new Float32Array(e,d+c,2);b[0]=this.A[0][0];b[1]=this.A[0][1];c+=8;d=new Float32Array(e,d+c,3);d[0]=0;d[1]=0;d[2]=0;c+=12;this.g[this.g.length]=
a++}this.L.fill(e)}a=this.g.length;c=x;c=255>a?new Uint8Array(this.g):65535>a?new Uint16Array(this.g):new Uint32Array(this.g);this.r.fill(c)};Wa.prototype.Q=function(a){if(a[0]instanceof Array)this.b=a;else for(var b=[],c=0,d=a.length;c<d;c+=9){for(var b=[],e=c,f=0;e<c+9;e+=3,f++)b[f]=[a[e],a[e+1],a[e+2]];this.b[this.b.length]=b}};Wa.prototype.R=function(a){if(a[0]instanceof Array)this.k=a;else for(var b=0,c=a.length;b<c;b+=3)this.k[this.k.length]=[a[b],a[b+1],a[b+2]]};
function Xa(a,b){if(b[0]instanceof Array)a.A=b;else for(var c=0,d=b.length;c<d;c+=2)a.A[a.A.length]=[b[c],b[c+1]]}Wa.prototype.K=function(a){if(a[0]instanceof Array)this.h=a;else for(var b=0,c=a.length;b<c;b+=3)this.h[this.h.length]=[a[b],a[b+1],a[b+2]]};function Ya(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);};function Za(a){new ca("data/head.a3",function(b,c){var d=x,e=Ya(c),f=/(?:\.([^.]+))?$/.exec(b)[1];"json"==f?(d=new Wa,d.K(e.vertices),d.R(e.normals),Xa(d,e.texturePositions),d.g=e.indices,d.B()):"a3"==f&&(d=new Wa,d.K(e.vertices),Xa(d,e.uv),d.Q(e.faces),d.B());a(d)})};var $a=x,ab=x,bb=x;window.ka=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};
window.application=function(){function a(){h=(new Date).getTime();window.ka(a);$a.P(ab,bb);Ba(g.m,3*Math.sin(h/1E3)/10,0.1,3*Math.cos(h/1E3)/10)}var b=function(){var a=window,b="inner";"innerWidth"in window||(b="client",a=document.documentElement||document.body);return{width:a[b+"Width"],height:a[b+"Height"]}}(),c=b.width,b=b.height,d=new Ua;d.J(c,b);Sa(d);$a=d;var e=new Oa;ab=e;c=new Pa("3D");Ba(c,0,0,2);Qa(c);Ba(c,0,0,0);bb=c;new Za(function(a){a=new Ja({e:a,c:new La});a.c.V=4;oa(a.c,f);Ba(a.m,
0,0,0);Ca(a.m);e.add(a)});var c=Ka(),f=new $("data/metal.jpg"),g=new Va;Na(g);Ba(g.m,0,0,-10);e.add(g);c=new Ja({e:c,c:new La});c.m=g.m;oa(c.c,f);Ca(c.m);e.add(c);var h=0;a()};window.onresize=function(){$a.J(window.innerWidth,window.innerHeight)};
