var n=!0,q=null,r=!1;function v(a){return function(){return this[a]}}var aa=this;function ba(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&void 0!==b?d[e]=b:d=d[e]?d[e]:d[e]={}}function ca(a){a.p=function(){return a.D?a.D:a.D=new a}}function x(a,b){function c(){}c.prototype=b.prototype;a.qa=b.prototype;a.prototype=new c};function da(){this.value=0}var ea=[],fa=1;da.prototype.C=function(a){var b=ea[a];void 0==b&&(b=fa,ea[a]=b,fa<<=1);return b};function ga(){this.S=n;this.entities=[];this.K=0;this.key=new da};function ha(a,b){ga.call(this);this.k=a;this.v=b;var c=this.key;c.value|=c.C("MeshComponent")}x(ha,ga);function y(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}y.prototype.BYTES_PER_ELEMENT=8;y.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};y.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{y.BYTES_PER_ELEMENT=8}catch(ia){}y.prototype.BYTES_PER_ELEMENT=y.prototype.BYTES_PER_ELEMENT;y.prototype.set=y.prototype.set;y.prototype.toString=y.prototype.toString;ba("Float64Array",y)};function z(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}z.prototype.BYTES_PER_ELEMENT=4;z.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};z.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(z.BYTES_PER_ELEMENT=4,z.prototype.BYTES_PER_ELEMENT=z.prototype.BYTES_PER_ELEMENT,z.prototype.set=z.prototype.set,z.prototype.toString=z.prototype.toString,ba("Float32Array",z));function ja(a,b){var c=new Float32Array(3);c[0]=a;c[1]=1;c[2]=b;return c}function ka(a,b){var c=a[0],d=a[1],e=a[2],c=1/Math.sqrt(c*c+d*d+e*e);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c}function la(a,b,c){var d=a[0],e=a[1];a=a[2];var g=b[0],k=b[1];b=b[2];c[0]=e*b-a*k;c[1]=a*g-d*b;c[2]=d*k-e*g};function A(){return new Float32Array(16)}function ma(a,b,c,d,e,g,k,m,j,h,f,l,s,u,t,p,w){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=g;a[5]=k;a[6]=m;a[7]=j;a[8]=h;a[9]=f;a[10]=l;a[11]=s;a[12]=u;a[13]=t;a[14]=p;a[15]=w;return a}function na(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}function oa(a,b,c,d){var e=a[1]*b+a[5]*c+a[9]*d+a[13],g=a[2]*b+a[6]*c+a[10]*d+a[14],k=a[3]*b+a[7]*c+a[11]*d+a[15];a[12]=a[0]*b+a[4]*c+a[8]*d+a[12];a[13]=e;a[14]=g;a[15]=k}new Float64Array(3);new Float64Array(3);
var pa=[new Float64Array(4),new Float64Array(4),new Float64Array(4)];new Float64Array(16);function B(){var a=A();a[0]=a[5]=a[10]=a[15]=1;this.a=a;this.position=new Float32Array(3);this.rotation=new Float32Array(3);this.scale=ja(1,1);this.c=n}B.prototype.l=function(a,b,c){var d=this.position;d[0]=a;d[1]=b;d[2]=c;this.c=n};
B.prototype.q=function(){if(this.c){var a=this.a;a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;a[12]=0;a[13]=0;a[14]=0;a[15]=1;oa(this.a,this.position[0],this.position[1],this.position[2]);var a=this.a,b=this.rotation[0],c=a[4],d=a[5],e=a[6],g=a[7],k=a[8],m=a[9],j=a[10],h=a[11],f=Math.cos(b),b=Math.sin(b);a[4]=c*f+k*b;a[5]=d*f+m*b;a[6]=e*f+j*b;a[7]=g*f+h*b;a[8]=c*-b+k*f;a[9]=d*-b+m*f;a[10]=e*-b+j*f;a[11]=g*-b+h*f;a=this.a;b=this.rotation[1];
c=a[0];d=a[1];e=a[2];g=a[3];k=a[8];m=a[9];j=a[10];h=a[11];f=Math.cos(b);b=Math.sin(b);a[0]=c*f+k*-b;a[1]=d*f+m*-b;a[2]=e*f+j*-b;a[3]=g*f+h*-b;a[8]=c*b+k*f;a[9]=d*b+m*f;a[10]=e*b+j*f;a[11]=g*b+h*f;a=this.a;b=this.rotation[2];c=a[0];d=a[1];e=a[2];g=a[3];k=a[4];m=a[5];j=a[6];h=a[7];f=Math.cos(b);b=Math.sin(b);a[0]=c*f+k*b;a[1]=d*f+m*b;a[2]=e*f+j*b;a[3]=g*f+h*b;a[4]=c*-b+k*f;a[5]=d*-b+m*f;a[6]=e*-b+j*f;a[7]=g*-b+h*f;a=this.a;c=this.scale[0];d=this.scale[1];e=this.scale[2];ma(a,a[0]*c,a[1]*c,a[2]*c,a[3]*
c,a[4]*d,a[5]*d,a[6]*d,a[7]*d,a[8]*e,a[9]*e,a[10]*e,a[11]*e,a[12],a[13],a[14],a[15]);this.c=r}return this.a};function C(a){this.parent=q;this.children=[];this.I=0;this.Q=a||new B};function qa(){var a=new Float32Array(4);a[0]=1;a[1]=1;a[2]=1;a[3]=1;this.value=a}qa.prototype.C=v("value");function D(a){B.call(this);this.G=A();this.s=A();this.na=new Float32Array(9);this.R=ja(0,0);this.viewport={x:0,y:0,width:800,height:600};this.L=45;this.l(0,0,2);ra(this);this.l(0,0,0);switch(a){case "2D":a=A();this.s=ma(a,1,0,0,0,0,1,0,0,0,0,-2/99,0,-0,-0,-101/99,1);this.c=n;break;default:var b=this.L;a=this.viewport.width/this.viewport.height;var c=A(),b=b/2,d=Math.sin(b);0==d||0==a?a=c:(b=Math.cos(b)/d,a=ma(c,b/a,0,0,0,0,b,0,0,0,0,-101/99,-1,0,0,-200/99,0));this.s=a;this.c=n}}x(D,B);
function ra(a){var b=A(),c=a.position,d=a.R,e=pa[0],g=[0,0,0];e[0]=g[0]-c[0];e[1]=g[1]-c[1];e[2]=g[2]-c[2];ka(e,e);e[3]=0;g=pa[1];la(e,d,g);ka(g,g);g[3]=0;d=pa[2];la(g,e,d);ka(d,d);d[3]=0;e[0]=-e[0];e[1]=-e[1];e[2]=-e[2];na(b,0,g);na(b,1,d);na(b,2,e);b[3]=0;b[7]=0;b[11]=0;b[15]=1;oa(b,-c[0],-c[1],-c[2]);a.G=b;a.c=n}
D.prototype.q=function(){if(this.c){var a=this.G,b=A();b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];this.a=b;var c=this.s,d=this.a,a=this.a,b=c[0],e=c[1],g=c[2],k=c[3],m=c[4],j=c[5],h=c[6],f=c[7],l=c[8],s=c[9],u=c[10],t=c[11],p=c[12],w=c[13],I=c[14],c=c[15],J=d[0],K=d[1],L=d[2],M=d[3],N=d[4],P=d[5],Q=d[6],R=d[7],S=d[8],T=d[9],U=d[10],V=d[11],W=d[12],X=d[13],Y=d[14],d=d[15];
a[0]=b*J+m*K+l*L+p*M;a[1]=e*J+j*K+s*L+w*M;a[2]=g*J+h*K+u*L+I*M;a[3]=k*J+f*K+t*L+c*M;a[4]=b*N+m*P+l*Q+p*R;a[5]=e*N+j*P+s*Q+w*R;a[6]=g*N+h*P+u*Q+I*R;a[7]=k*N+f*P+t*Q+c*R;a[8]=b*S+m*T+l*U+p*V;a[9]=e*S+j*T+s*U+w*V;a[10]=g*S+h*T+u*U+I*V;a[11]=k*S+f*T+t*U+c*V;a[12]=b*W+m*X+l*Y+p*d;a[13]=e*W+j*X+s*Y+w*d;a[14]=g*W+h*X+u*Y+I*d;a[15]=k*W+f*X+t*Y+c*d;this.c=r}return this.a};D.prototype.l=function(a,b,c){B.prototype.l.call(this,a,b,c);ra(this);this.c=n};function sa(){C.call(this);this.color=new qa;this.direction=ja(1,1);this.U=new qa;this.W=n}x(sa,C);function ta(){sa.call(this)}x(ta,sa);function ua(){C.call(this);this.T=new ta;this.la=[];this.ma=0}x(ua,C);function va(a){this.Z=[];this.h=a};function wa(a){this.K=0;this.h=a};function xa(a){this.P=[];this.w=0;this.h=a}xa.prototype.m=function(a){this.P[this.w]=a;this.w++};xa.prototype.update=function(){for(var a=0,b=this.w;a<b;++a);};function ya(){this.Y=new va(this);this.$=new wa(this);this.F=new xa(this)}ya.prototype.m=function(a){this.F.m(a)};ya.prototype.update=function(){this.F.update()};function E(){this.H=new D("3D");this.v=new ua;this.h=new ya}E.prototype.u=function(a){a.u(this.v,this.H)};E.prototype.start=function(a){a=new ha(a.k,this.v);this.h.m(a)};E.prototype.update=function(){this.h.update()};window.O=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};function za(){}za.prototype.create=function(a){var b=q;try{var c={premultipliedAlpha:r,alpha:r},b=a.getContext("webgl",c)||a.getContext("experimental-webgl",c)}catch(d){}b===q&&alert("Missing context");return b};function F(){this.J=new za;this.A=[];this.n=q}ca(F);function G(){return F.p().n}F.prototype.create=function(a){a=this.J.create(a);this.A[this.A.length]=a;this.n==q&&(this.n=a);return a};function H(){this.data=q;this.height=this.width=0;this.t=r;this.X=q}H.prototype.i=v("height");H.prototype.j=v("width");H.prototype.getData=v("data");function Aa(){H.call(this);this.data=new Image}x(Aa,H);function Z(a){a=a||G();this.id=a.createTexture();this.source=q;this.t=r}Z.prototype.bind=function(){G().bindTexture(3553,this.id)};Z.prototype.create=function(a,b){var c=G(),d;d=new Aa;d=this.source=d;d.width=a;d.height=b;this.bind();Ba(9985);this.source.j()==this.source.i()&&G().generateMipmap(3553);c.texImage2D(3553,0,6408,a,b,0,6408,5121,q);G().bindTexture(3553,q)};
Z.prototype.fill=function(a){var b=G();this.bind();Ba(9729);b.pixelStorei(37440,1);b.texImage2D(3553,0,6408,6408,5121,a);G().bindTexture(3553,q);this.t=n};function Ba(a){var b=G();b.texParameteri(3553,10241,a);b.texParameteri(3553,10240,9729)}Z.prototype.update=function(){this.fill(this.source.getData())};Z.prototype.i=function(){return this.source.i()};Z.prototype.j=function(){return this.source.j()};function Ca(a){this.N=a}Ca.prototype.create=function(){return new Z(this.N)};function Da(){this.d=this.o=this.g=q;this.z=[];this.ta=33984}Da.prototype.clear=function(){this.g=this.ra=this.d=q;this.z=[]};Da.prototype.useProgram=function(a,b){a!=this.d&&(this.d=a,this.d.bind(),this.d.ba().uMvp.data=b.q(),this.d.oa())};function Ea(a){this.b=F.p().create(a);this.sa=new Ca(this.b);this.e=new Da;this.b.enable(2929);this.b.depthFunc(513)}Ea.prototype.u=function(a,b){this.b.clearColor(0.2,0.2,0.2,1);this.b.clear(16640);this.b.viewport(b.viewport.x,b.viewport.y,b.viewport.width,b.viewport.height);Fa(this,b,a,a.children);this.e.clear()};
function Fa(a,b,c,d){var e=0;for(c=c.I;e<c;++e){var g=a,k=b,m=d[e],j=g,h=m;if(!(h.B()==q||h.M()==q)){var f=h.B(),l=f.ga();j.e.useProgram(l,k);l.fa().uModel.data=h.Q.q();l.pa();for(var l=j.e,s=h.B(),u=j.b,t=s.ia(),p=0,s=s.ha();p<s;++p){var w=33984+p-33984;l.z[w]!=t[p]&&t[p].t&&(u.activeTexture(33984),t[p].bind(),l.z[w]=t[p])}l=j.e;h=h.M();u=j.b;h!=l.g&&(l.g=h,l.o=l.g.ca(),l.o.V(l.d.aa(),u));j.b.drawElements(f.da(),j.e.g.ea(),j.e.o.ka.ja(),0)}Fa(g,k,m,m.children)}}Ea.prototype.i=function(){return 0};
Ea.prototype.j=function(){return 0};function $(){this.k=this.f=q}$.prototype.r=function(){};$.prototype.start=function(){this.update()};$.prototype.update=function(){window.O(this.update.bind(this));this.f!=q&&(this.f.update(this),this.f.u(this.k))};$.prototype.clear=function(){this.r()};function Ga(){$.call(this)}x(Ga,$);ca(Ga);Ga.prototype.r=function(){this.f=new E;this.k=new Ea(document.getElementById("test"));this.f.start(this)};window.application=function(){var a=Ga.p();a.r();a.start()};
